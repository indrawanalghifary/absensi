(()=>{var e={};e.id=172,e.ids=[172],e.modules={10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79428:e=>{"use strict";e.exports=require("buffer")},55511:e=>{"use strict";e.exports=require("crypto")},94735:e=>{"use strict";e.exports=require("events")},81630:e=>{"use strict";e.exports=require("http")},55591:e=>{"use strict";e.exports=require("https")},91645:e=>{"use strict";e.exports=require("net")},33873:e=>{"use strict";e.exports=require("path")},11997:e=>{"use strict";e.exports=require("punycode")},27910:e=>{"use strict";e.exports=require("stream")},34631:e=>{"use strict";e.exports=require("tls")},79551:e=>{"use strict";e.exports=require("url")},74075:e=>{"use strict";e.exports=require("zlib")},60400:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var r=t(70260),a=t(28203),i=t(25155),n=t.n(i),l=t(67292),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(s,o);let d=["",{children:["kamera",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,89984)),"/home/fahmy/Documents/Project/project web/absensi/app/kamera/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,19611)),"/home/fahmy/Documents/Project/project web/absensi/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,61129)),"/home/fahmy/Documents/Project/project web/absensi/app/not-found.tsx"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,41485,23)),"next/dist/client/components/unauthorized-error"]}],c=["/home/fahmy/Documents/Project/project web/absensi/app/kamera/page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/kamera/page",pathname:"/kamera",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},36397:(e,s,t)=>{Promise.resolve().then(t.bind(t,89984))},13:(e,s,t)=>{Promise.resolve().then(t.bind(t,34212))},34212:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>c});var r=t(45512),a=t(58009),i=t(87006),n=t(79334),l=t(22526),o=t(63412),d=t(32621);function c(){let[e,s]=(0,a.useState)(!1),[t,c]=(0,a.useState)(""),[u,m]=(0,a.useState)(""),[x,p]=(0,a.useState)(null),[h,b]=(0,a.useState)(!1),[g,j]=(0,a.useState)(null),[f,k]=(0,a.useState)(!1),[v,y]=(0,a.useState)(!1),N=(0,a.useRef)(null),w=(0,a.useRef)(null),P=(0,a.useRef)(null),{user:q}=(0,i.A)(),A=(0,n.useRouter)(),_=async()=>{try{let e=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:640},height:{ideal:480},facingMode:"user"}});N.current&&(N.current.srcObject=e,P.current=e,k(!0))}catch(e){c("Gagal mengakses kamera. Pastikan izin kamera telah diberikan.")}},C=()=>{P.current&&(P.current.getTracks().forEach(e=>e.stop()),P.current=null,k(!1))},S=async()=>{if(!g||!x||!q){c("Foto, lokasi, dan user diperlukan untuk absensi");return}s(!0),c("");try{let e=await (0,d.w_)(g,x,q.id,q.email||"");m(`Absensi berhasil disimpan! Status: ${e.status}`),setTimeout(()=>{A.push("/dashboardsiswa")},2e3)}catch(e){c(e.message||"Gagal menyimpan absensi. Silakan coba lagi.")}finally{s(!1)}};return(0,r.jsx)(o.A,{children:(0,r.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,r.jsx)(l.A,{}),(0,r.jsx)("main",{className:"p-4 lg:p-6",children:(0,r.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-6 text-center",children:"Absensi dengan Kamera"}),(0,r.jsxs)("div",{className:"mb-6 p-4 bg-blue-50 rounded-lg",children:[(0,r.jsx)("h3",{className:"font-semibold text-blue-900 mb-2",children:"Status Lokasi"}),x?(0,r.jsxs)("div",{className:"text-sm text-blue-700",children:[(0,r.jsx)("p",{children:"✅ Lokasi berhasil didapatkan"}),(0,r.jsxs)("p",{children:["Koordinat: ",x.latitude.toFixed(6),", ",x.longitude.toFixed(6)]}),(0,r.jsxs)("p",{children:["Akurasi: \xb1",x.accuracy.toFixed(0)," meter"]})]}):(0,r.jsx)("p",{className:"text-yellow-700",children:"\uD83D\uDCCD Sedang mendapatkan lokasi..."})]}),(0,r.jsx)("div",{className:"mb-6",children:v?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("i",{className:"ri-check-line text-2xl text-green-600"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Sudah Absen Hari Ini"}),(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:"Anda sudah melakukan absensi untuk hari ini"}),(0,r.jsx)("button",{onClick:()=>A.push("/dashboardsiswa"),className:"bg-indigo-600 text-white px-6 py-2 rounded-lg hover:bg-indigo-700",children:"Kembali ke Dashboard"})]}):(0,r.jsxs)(r.Fragment,{children:[!f&&!h&&(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"w-full h-64 bg-gray-200 rounded-lg flex items-center justify-center mb-4",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("i",{className:"ri-camera-line text-4xl text-gray-400 mb-2"}),(0,r.jsx)("p",{className:"text-gray-500",children:"Kamera belum aktif"})]})}),(0,r.jsxs)("button",{onClick:_,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700",children:[(0,r.jsx)("i",{className:"ri-camera-line mr-2"}),"Aktifkan Kamera"]})]}),f&&!h&&(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("video",{ref:N,autoPlay:!0,playsInline:!0,className:"w-full max-w-md mx-auto rounded-lg mb-4"}),(0,r.jsxs)("div",{className:"space-x-4",children:[(0,r.jsxs)("button",{onClick:()=>{if(N.current&&w.current){let e=w.current,s=N.current;e.width=s.videoWidth,e.height=s.videoHeight;let t=e.getContext("2d");t&&(t.drawImage(s,0,0),e.toBlob(e=>{e&&(j(e),b(!0),C())},"image/jpeg",.8))}},className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700",children:[(0,r.jsx)("i",{className:"ri-camera-fill mr-2"}),"Ambil Foto"]}),(0,r.jsxs)("button",{onClick:C,className:"bg-gray-600 text-white px-6 py-2 rounded-lg hover:bg-gray-700",children:[(0,r.jsx)("i",{className:"ri-close-line mr-2"}),"Batal"]})]})]}),h&&(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("canvas",{ref:w,className:"w-full max-w-md mx-auto rounded-lg mb-4"}),(0,r.jsx)("div",{className:"space-x-4",children:(0,r.jsxs)("button",{onClick:()=>{b(!1),j(null),_()},className:"bg-yellow-600 text-white px-6 py-2 rounded-lg hover:bg-yellow-700",children:[(0,r.jsx)("i",{className:"ri-refresh-line mr-2"}),"Foto Ulang"]})})]})]})}),t&&(0,r.jsx)("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,r.jsxs)("p",{className:"text-red-700",children:["❌ ",t]})}),u&&(0,r.jsx)("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg",children:(0,r.jsxs)("p",{className:"text-green-700",children:["✅ ",u]})}),h&&x&&(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)("button",{onClick:S,disabled:e,className:"bg-indigo-600 text-white px-8 py-3 rounded-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed",children:e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("i",{className:"ri-loader-line animate-spin mr-2"}),"Menyimpan Absensi..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("i",{className:"ri-check-line mr-2"}),"Kirim Absensi"]})})}),(0,r.jsxs)("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[(0,r.jsx)("h4",{className:"font-semibold text-gray-900 mb-2",children:"Petunjuk:"}),(0,r.jsxs)("ul",{className:"text-sm text-gray-600 space-y-1",children:[(0,r.jsx)("li",{children:"• Foto akan diambil menggunakan kamera depan"}),(0,r.jsx)("li",{children:"• Lokasi akan otomatis terdeteksi"}),(0,r.jsx)("li",{children:"• Pastikan pencahayaan cukup untuk foto yang jelas"})]})]})]})})})]})})}},89984:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>r});let r=(0,t(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/fahmy/Documents/Project/project web/absensi/app/kamera/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/fahmy/Documents/Project/project web/absensi/app/kamera/page.tsx","default")}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[388,730,822],()=>t(60400));module.exports=r})();